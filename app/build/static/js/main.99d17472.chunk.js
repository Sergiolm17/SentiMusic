(window.webpackJsonpapp=window.webpackJsonpapp||[]).push([[0],[,,function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c});var r="https://us-central1-domo-music.cloudfunctions.net/app",o=r+"/login",c=r+"/refresh_token?"},,,function(e,t,n){"use strict";var r=n(3),o=n(8),c=n.n(o),a=(n(33),{apiKey:"AIzaSyALTJda55N9Xs_i-dQ5V5BWyR37cU3CMDA",authDomain:"domo-music.firebaseapp.com",databaseURL:"https://domo-music.firebaseio.com",projectId:"domo-music",storageBucket:"domo-music.appspot.com",messagingSenderId:"550634181029",appId:"1:550634181029:web:5f28c1b8216991d346184c"});c.a.initializeApp(a);var i=c.a;function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}n.d(t,"b",function(){return l}),n.d(t,"c",function(){return f}),n.d(t,"a",function(){return d});var u=i.firestore();function l(e,t){if(e.id){var n=u.collection("users").doc(e.id);n.get().then(function(o){o.exists?t(o.data()):(n.set(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(n,!0).forEach(function(t){Object(r.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e)),console.log("No such document!"),t(e,"No such document!"))})}else t(null,"Not receive user")}function f(e,t,n){e?(console.log(e),u.collection("users").doc(e.id).set(t,{merge:!0}).then(function(){n(t)}).catch(function(e){n(null,e)})):n(null,"No such user!")}function d(e,t,n){e.id&&i.firestore().collection("transition").add({user:e.id,from:t,to:n,date:new Date})}},,function(e,t,n){"use strict";var r=n(3),o=n(1),c=n(0),a=n(4),i=n.n(a),s=(new i.a,function(){var e,t={},n=/([^&;=]+)=?([^&;]*)/g,r=window.location.hash.substring(1);for(e=n.exec(r);e;)t[e[1]]=decodeURIComponent(e[2]),e=n.exec(r);return t}),u=n(2),l=n(5);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(n,!0).forEach(function(t){Object(r.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,"b",function(){return p}),n.d(t,"d",function(){return g}),n.d(t,"e",function(){return O}),n.d(t,"f",function(){return h}),n.d(t,"a",function(){return y}),n.d(t,"c",function(){return j});var m=new i.a,b=n(36);function p(){var e=s(),t=Object(c.useState)(!1),n=Object(o.a)(t,2),r=n[0],a=n[1],i=Object(c.useState)(localStorage.getItem("access_token")||e.access_token||""),u=Object(o.a)(i,1)[0],l=Object(c.useState)(localStorage.getItem("refresh_token")||e.refresh_token||""),f=Object(o.a)(l,1)[0];return Object(c.useEffect)(function(){u&&(m.setAccessToken(u),localStorage.setItem("access_token",u),localStorage.setItem("refresh_token",f)),a(!!u)},[u,f]),r}var g=function(){var e=Object(c.useState)({}),t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)(function(){m.getMe().then(function(e){r(e)})},[]),[n]},O=function(){var e=Object(c.useState)({name:"",artist:"",albumArt:"",is_playing:!1,uri:"",id:""}),t=Object(o.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),i=Object(o.a)(a,2),l=i[0],f=i[1],d=Object(c.useState)(!1),p=Object(o.a)(d,2),g=p[0],O=p[1];return Object(c.useEffect)(function(){n();var e=!1,t=setInterval(function(){return n()},4e3);function n(){return localStorage.getItem("access_token")&&m.getMyCurrentPlaybackState(function(n,o){n?localStorage.getItem("refresh_token")&&function(e,t){var n=s();fetch(u.b+b.stringify({refresh_token:localStorage.getItem("refresh_token")||n.refresh_token})).then(function(e){return e.json()}).then(function(e){console.log(e),t(e)})}(JSON.parse(n.response).error,function(e){e.access_token?m.setAccessToken(e.access_token):(O(!0),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),clearInterval(t))}):(e=!!o&&o.is_playing,O(!1),f(!!o&&o.is_playing),o.item&&"episode"!==o.currently_playing_type&&r({name:o.item.name,albumArt:o.item.album.images[0].url,is_playing:o.is_playing,uri:o.item.uri,id:o.item.id,artist:o.item.artists[0].name}))}),e}return function(){clearInterval(t)}},[]),{nowPlaying:n,error:g,current:l}};var h=function(e,t,n){var r=Object(c.useState)([]),a=Object(o.a)(r,2),i=a[0],s=a[1],u=v(),l=Object(o.a)(u,1)[0];return Object(c.useEffect)(function(){var r=d({},function(){if(l){if(0===l.length)return{};var t="".concat(l.join(",")).concat(e.id?","+e.id:"");if(t)return{seed_tracks:t}}return{}}(),{},function(e){return 0===e?{}:1===e?{min_valence:.5}:2===e?{max_valence:.5}:3===e?{}:void 0}(t),{},function(e){return e?{seed_genres:e}:{}}(n));m.getRecommendations(d({limit:15,market:"PE"},r),function(e,t){e||s(t.tracks)})},[t,n,l]),[i]},v=function(){var e=Object(c.useState)([]),t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)(function(){m.getMySavedTracks({limit:4,offset:0,market:"PE"}).then(function(e){var t=e.items.map(function(e){return e.track.id});r(t)})},[]),[n]},j=function(){var e=g(),t=Object(o.a)(e,1)[0],n=Object(c.useState)(null),r=Object(o.a)(n,2),a=r[0],i=r[1],s=Object(c.useState)({}),u=Object(o.a)(s,2),f=u[0],d=u[1];return Object(c.useEffect)(function(){a&&localStorage.setItem("playlist_id",a)},[a]),Object(c.useEffect)(function(){t&&Object(l.b)(t,function(e,n){e&&(e.playlist_id?m.getPlaylist(e.playlist_id).then(function(e){e.id?(d(e),i(e.id)):Object(l.c)(t,{playlist_id:""},function(e,t){return console.log(e,t)})}):m.createPlaylist(t.id,{name:"Domo Playlist",public:!1,collaborative:!1,description:"Playlist de musica recomendada"}).then(function(e){Object(l.c)(t,{playlist_id:e.id},function(e,t){return console.log(e,t)}),i(e.id),d(e)}))})},[t]),[f]};function y(e,t){console.log(e,t),m.addTracksToPlaylist(e,[t]).then(function(e){console.log(e),m.play(),alert("Se a\xf1adio con exito")})}},,function(e,t,n){"use strict";var r=n(0),o=n.n(r);n(31);t.a=function(e){var t=e.children,n=e.normal;return o.a.createElement("div",{className:"".concat(n&&"normal"," card ")},t)}},function(e,t,n){"use strict";var r=n(0),o=n.n(r);n(32);t.a=function(e){var t=e.children,n=e.href,r=e.newtab,c=e.button,a=e.onClick;return c&&a?o.a.createElement("button",{className:"button-domo",onClick:a},t):o.a.createElement("a",{href:n,target:r?"_blank":"_self",className:"button-domo"},t)}},,,,,,,function(e,t,n){e.exports=n.p+"static/media/DOMO.554d941c.svg"},function(e,t,n){e.exports=n.p+"static/media/Logo.75f61d59.svg"},,,,,,function(e,t,n){e.exports=n(39)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=n(16),a=n.n(c),i=(n(29),n(30),n(17)),s=n.n(i),u=n(18),l=n.n(u),f=n(9),d=n(10),m=n(2),b={margin:"20px"},p=function(){return o.a.createElement("div",{className:"App-header"},o.a.createElement(f.a,null,o.a.createElement("p",null,o.a.createElement("img",{src:s.a,alt:"texto",style:b})),o.a.createElement("p",null,o.a.createElement("img",{src:l.a,alt:"Logo Domo",style:b})),o.a.createElement(d.a,{href:m.a,style:b},"Iniciar sesion con spotify")))},g=n(7),O=Object(r.lazy)(function(){return n.e(3).then(n.bind(null,49))});var h=function(){var e=Object(g.b)(),t=Object(g.e)().error;return!e||t?o.a.createElement(p,null):o.a.createElement(r.Suspense,{fallback:o.a.createElement(o.a.Fragment,null)},o.a.createElement(O,null))},v=n(19),j=n(20),y=n(22),w=n(21),k=n(23),E=function(e){function t(e){var n;return Object(v.a)(this,t),(n=Object(y.a)(this,Object(w.a)(t).call(this,e))).state={hasError:!1},n}return Object(k.a)(t,e),Object(j.a)(t,[{key:"componentDidCatch",value:function(e,t){console.log(e,t)}},{key:"render",value:function(){return this.state.hasError?o.a.createElement(p,null):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(o.a.Component),S=Boolean("34.68.6.184"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function _(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}a.a.render(o.a.createElement(E,null,o.a.createElement(h,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");S?(!function(e,t){fetch(e).then(function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):_(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):_(t,e)})}}()}],[[24,1,2]]]);
//# sourceMappingURL=main.99d17472.chunk.js.map