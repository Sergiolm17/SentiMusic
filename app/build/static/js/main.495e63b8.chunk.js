(window.webpackJsonpapp=window.webpackJsonpapp||[]).push([[0],{10:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return c});var o="https://us-central1-domo-music.cloudfunctions.net/app",r=o+"/login",c=o+"/refresh_token?"},12:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"c",function(){return m}),n.d(t,"a",function(){return g}),n.d(t,"d",function(){return b});var o=n(23),r=n.n(o),c=n(34),a=n(2),i=n(15),s=n(3),u=n(0);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}var f=s.b.firestore();function d(e,t){if(e.id){s.a.setUserId(e.id);var n=f.collection("users").doc(e.id);n.get().then(function(o){o.exists?(t(o.data()),s.a.setCurrentScreen("hola")):(n.set(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(n,!0).forEach(function(t){Object(i.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e)),console.log("No such document!"),t(e,"No such document!"))})}else t(null,"Not receive user")}function m(e,t,n){e?(console.log(e),f.collection("users").doc(e.id).set(t,{merge:!0}).then(function(){n(t)}).catch(function(e){n(null,e)})):n(null,"No such user!")}function g(e,t,n){e.id&&(s.a.logEvent("post_accion",{user:e.id,from:t,to:n,date:new Date}),s.b.firestore().collection("transition").add({user:e.id,from:t,to:n,date:new Date}))}function b(){var e=Object(u.useState)(!1),t=Object(a.a)(e,2),n=t[0];t[1];return Object(u.useEffect)(function(){function e(){return(e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.d.fetchAndActivate();case 2:console.log("Remote-config initialized"),console.log(s.d.getString("testeo"));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[n]}},20:function(e,t,n){"use strict";var o=n(15),r=n(2),c=n(0),a=n(16),i=n.n(a),s=(new i.a,function(){var e,t={},n=/([^&;=]+)=?([^&;]*)/g,o=window.location.hash.substring(1);for(e=n.exec(o);e;)t[e[1]]=decodeURIComponent(e[2]),e=n.exec(o);return t}),u=n(10),l=n(12),f=n(3);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach(function(t){Object(o.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,"b",function(){return p}),n.d(t,"e",function(){return v}),n.d(t,"f",function(){return h}),n.d(t,"g",function(){return O}),n.d(t,"a",function(){return w}),n.d(t,"d",function(){return y}),n.d(t,"c",function(){return j});var g=new i.a,b=n(61);function p(){var e=Object(l.d)(),t=(Object(r.a)(e,1)[0],s()),n=Object(c.useState)(!0),o=Object(r.a)(n,2),a=o[0],i=o[1],u=Object(c.useState)(localStorage.getItem("access_token")||t.access_token||""),f=Object(r.a)(u,1)[0],d=Object(c.useState)(localStorage.getItem("refresh_token")||t.refresh_token||""),m=Object(r.a)(d,1)[0];return Object(c.useEffect)(function(){f&&(g.setAccessToken(f),localStorage.setItem("access_token",f),localStorage.setItem("refresh_token",m)),console.log(f),i(!!f)},[f,m]),a}var v=function(){var e=Object(c.useState)({}),t=Object(r.a)(e,2),n=t[0],o=t[1];return Object(c.useEffect)(function(){g.getMe().then(function(e){o(e)})},[]),[n]},h=function(){var e=Object(c.useState)({name:"",artist:"",albumArt:"",is_playing:!1,uri:"",id:""}),t=Object(r.a)(e,2),n=t[0],o=t[1],a=Object(c.useState)(!1),i=Object(r.a)(a,2),l=i[0],d=i[1],m=Object(c.useState)(!1),p=Object(r.a)(m,2),v=p[0],h=p[1];return Object(c.useEffect)(function(){var e=!1,t=setInterval(function(){return function(){localStorage.getItem("access_token")&&g.getMyCurrentPlaybackState(function(n,r){n?localStorage.getItem("refresh_token")&&function(e,t){var n=s();fetch(u.b+b.stringify({refresh_token:localStorage.getItem("refresh_token")||n.refresh_token})).then(function(e){return e.json()}).then(function(e){console.log(e),t(e)})}(JSON.parse(n.response).error,function(e){e.access_token?g.setAccessToken(e.access_token):(h(!0),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),clearInterval(t))}):(e=!!r&&r.is_playing,h(!1),d(!!r&&r.is_playing),r.item&&"episode"!==r.currently_playing_type&&o({name:r.item.name,albumArt:r.item.album.images[0].url,is_playing:r.is_playing,uri:r.item.uri,id:r.item.id,artist:r.item.artists[0].name}))});return e}()},4e3);return function(){clearInterval(t)}},[]),Object(c.useEffect)(function(){console.log(n),n.uri&&(console.log("nowPlaying"),f.a.logEvent("now_playing",n))},[n.uri]),{nowPlaying:n,error:v,current:l}};var O=function(e,t,n,o){var a=Object(c.useState)([]),i=Object(r.a)(a,2),s=i[0],u=i[1];return Object(c.useEffect)(function(){var r=f.c.trace("get_Recomendation");r.start();var c=function(e){return e?{seed_genres:e}:{}},a=function(){if(o){if(0===o.length)return{};var t="".concat(o.join(",")).concat(e.id?","+e.id:"");if(t)return{seed_tracks:t}}return{}},i=a()||c(n)?m({},a(),{},function(e){return 0===e?{}:1===e?{min_valence:.5}:2===e?{max_valence:.5}:3===e?{}:void 0}(t),{},c(n)):{};console.log(i),g.getRecommendations(m({limit:15,market:"PE"},i),function(e,t){r.stop(),e||u(t.tracks)})},[t,n,o]),[s]},j=function(){var e=Object(c.useState)([]),t=Object(r.a)(e,2),n=t[0],o=t[1];return Object(c.useEffect)(function(){g.getMySavedTracks({limit:4,offset:0,market:"PE"}).then(function(e){var t=e.items.map(function(e){return e.track.id});o(t)})},[]),[n]},y=function(){var e=v(),t=Object(r.a)(e,1)[0],n=Object(c.useState)(null),o=Object(r.a)(n,2),a=o[0],i=o[1],s=Object(c.useState)({}),u=Object(r.a)(s,2),f=u[0],d=u[1];return Object(c.useEffect)(function(){a&&localStorage.setItem("playlist_id",a)},[a]),Object(c.useEffect)(function(){t&&Object(l.b)(t,function(e,n){e&&(e.playlist_id?g.getPlaylist(e.playlist_id).then(function(e){e.id?(d(e),i(e.id)):Object(l.c)(t,{playlist_id:""},function(e,t){return console.log(e,t)})}):g.createPlaylist(t.id,{name:"Domo Playlist",public:!1,collaborative:!1,description:"Playlist de musica recomendada"}).then(function(e){Object(l.c)(t,{playlist_id:e.id},function(e,t){return console.log(e,t)}),i(e.id),d(e)}))})},[t]),[f]};function w(e,t){console.log(e,t),g.addTracksToPlaylist(e,[t]).then(function(e){console.log(e),g.play(),alert("Se a\xf1adio con exito")})}},24:function(e,t,n){"use strict";var o=n(0),r=n.n(o);n(46);t.a=function(e){var t=e.children,n=e.normal;return r.a.createElement("div",{className:"".concat(n&&"normal"," card ")},t)}},25:function(e,t,n){"use strict";var o=n(0),r=n.n(o),c=n(3);n(54);t.a=function(e){var t=e.children,n=e.href,o=e.newtab,a=e.button,i=e.onClick;return a&&i?r.a.createElement("button",{className:"button-domo",onClick:i},t):r.a.createElement("a",{href:n,target:o?"_blank":"_self",onClick:function(){return c.a.logEvent("login")},className:"button-domo"},t)}},29:function(e,t,n){e.exports=n.p+"static/media/DOMO.554d941c.svg"},3:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return s});var o=n(9),r=n.n(o),c=(n(47),n(49),n(65),n(52),{apiKey:"AIzaSyALTJda55N9Xs_i-dQ5V5BWyR37cU3CMDA",authDomain:"domo-music.firebaseapp.com",databaseURL:"https://domo-music.firebaseio.com",projectId:"domo-music",storageBucket:"domo-music.appspot.com",messagingSenderId:"550634181029",appId:"1:550634181029:web:5f28c1b8216991d346184c",measurementId:"G-5S7136XK2T"});r.a.initializeApp(c);var a=r.a.analytics(),i=r.a.performance(),s=r.a.remoteConfig();s.settings={minimumFetchIntervalMillis:36e5,defaultConfig:{testeo:!0}},t.b=r.a},30:function(e,t,n){e.exports=n.p+"static/media/Logo.75f61d59.svg"},40:function(e,t,n){e.exports=n(64)},45:function(e,t,n){},46:function(e,t,n){},54:function(e,t,n){},59:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),c=n(28),a=n.n(c),i=(n(45),n(14)),s=n(8),u=n(29),l=n.n(u),f=n(30),d=n.n(f),m=n(24),g=n(25),b=n(10),p={margin:"20px"},v=function(){return r.a.createElement("div",{className:"App-header"},r.a.createElement(m.a,null,r.a.createElement("p",null,r.a.createElement("img",{src:l.a,alt:"texto",style:p})),r.a.createElement("p",null,r.a.createElement("img",{src:d.a,alt:"Logo Domo",style:p})),r.a.createElement(g.a,{href:b.a,style:p},"Iniciar sesion con spotify")))},h=function(e){var t={},n=/([^&;=]+)=?([^&;]*)/g,o=n.exec(e.location.search.substring(1));for(console.log(o);o;)t[o[1]]=decodeURIComponent(o[2]),o=n.exec(e.location.search.substring(1));return console.log(t),t?r.a.createElement(s.a,null):r.a.createElement("div",null,"props")},O=n(2),j=(n(59),n(20)),y=Object(o.lazy)(function(){return n.e(3).then(n.bind(null,75))});var w=function(){var e=Object(j.b)(),t=Object(j.f)(),n=t.error,c=t.nowPlaying,a=Object(o.useState)(!1),i=Object(O.a)(a,2),s=(i[0],i[1]);return Object(o.useEffect)(function(){s(!e||n)},[e,n]),!e||n?r.a.createElement(v,null):r.a.createElement(o.Suspense,{fallback:r.a.createElement(r.a.Fragment,null,"Cargando...")},r.a.createElement(y,{nowPlaying:c}))};var E=n(35),k=n(36),S=n(38),_=n(37),P=n(39),I=function(e){function t(e){var n;return Object(E.a)(this,t),(n=Object(S.a)(this,Object(_.a)(t).call(this,e))).state={hasError:!1},n}return Object(P.a)(t,e),Object(k.a)(t,[{key:"componentDidCatch",value:function(e,t){console.log(e,t)}},{key:"render",value:function(){return this.state.hasError?r.a.createElement(v,null):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(r.a.Component),x=Boolean("34.68.6.184"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function D(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}a.a.render(r.a.createElement(I,null,r.a.createElement(function(){return console.log(window.location.hash.substring(1)),r.a.createElement(i.a,null,r.a.createElement("div",null,r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/:id",exact:!0,component:h}),r.a.createElement(s.b,{path:"/",exact:!0},r.a.createElement(w,null)))))},null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");x?(!function(e,t){fetch(e).then(function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):D(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):D(t,e)})}}()}},[[40,1,2]]]);
//# sourceMappingURL=main.495e63b8.chunk.js.map